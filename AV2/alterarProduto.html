<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>

    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Alterar produto</title>

    <script type="text/javascript" src="js/funcoes.js">

    </script>
  </head>

  <body onload="dropCategoria(), dropTipo()">

    <nav class="navbar navbar-dark bg-dark  navbar-expand-lg ">

      <div class="collapse navbar-collapse justify-content-center" >

        <ul class="navbar-nav">

          <li class="nav-item">
            <a class="nav-link" href="index.html">Menu principal</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="insereProduto.html">Adicionar produto </a>
          </li>

          <li class="nav-item active">
            <a class="nav-link" href="alterarProduto.html">Alterar produto</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="listaTodos.html">Listar todas os Produtos</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="listaUm.html">Listar um Produto</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="removeProduto.html">Remover um produto</a>
          </li>

        </ul>

      </div>

    </nav>

    <div class="mx-auto" style="width: 600px;">

      <h1 style="margin: 60px 0px 20px 0px;" align="center">Alterar Produto</h1>

      <div class="mx-auto" style="width: 600px;"id="campo">

        <p style="margin-bottom: 60px;" align="center">Digite no campo abaixo o Codigo de barra do produto</p>

        <form class="form-row border border-secondary rounded" id="formCodigo" style="margin-bottom: 85px; padding: 20px;">

            <div class="form-group col-md-6">
              <label for="num">Codigo de barras</label>
              <input type="text" class="form-control" id="num" name="num" placeholder="Insira o codigo de barras">
            </div>

            <div class="form-group col-md-12">
                <input class="btn btn-primary" type="button" name="enviar" value="Enviar" onclick="preencheAlterar()">
            </div>

        </form>

      </div>

      <form class="form-row border border-secondary rounded" method="GET" action="" id="formProduto" style="margin-bottom: 85px; padding: 20px; display:none;">

          <div class="col-sm-6">
            <label for="nome">Nome</label>
            <input type="text" class="form-control" id="nome" name="nome" placeholder="Insira o nome do produto">
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="fabricante">Fabricante</label>
            <input type="text" class="form-control" id="fabricante" name="fabricante" placeholder="Insira o fabricante">
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="preco">Preço</label>
            <input type="number" class="form-control" id="preco" name="preco" placeholder="Insira o valor">
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="estoque">Quantidade em estoque</label>
            <input type="number" class="form-control" id="estoque" name="estoque" >
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="categ">Categoria</label>
            <select class="form-control" id="categ" name="categ" >

            </select>
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="tipo">Tipo do produto</label>
            <select class="form-control" id="tipo" name="tipo" >

            </select>
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="peso">Peso (gramas)</label>
            <input type="number" class="form-control" id="peso" name="peso" >
          </div>

          <div class="col-sm-6" style="margin-bottom: 40px;">
            <label for="data">Data de inclusão</label>
            <input type="date" class="form-control" id="data" name="data">
          </div>

          <div class="col-sm-12" style="margin-bottom: 40px;">
            <label for="num">Codigo de barra</label>
            <input type="number" class="form-control" id="num" name="num" placeholder="Insira o CB">
          </div>

          <div class="col-sm-12" style="margin-bottom: 40px;">
            <label for="desc">Descrição</label>
            <input type="text" class="form-control" name="descricao" id="descricao" name ="descricao">
          </div>

          <div class="form-group col-md-12 offset-5">
              <input type="button" class="btn btn-primary" value="Enviar" name="enviar" onclick="alterar()">
          </div>

          <script type="text/javascript">

            function dropCategoria(){

              let xmlHttp = new XMLHttpRequest();
              xmlHttp.onreadystatechange = function() {

                if (this.readyState == 4 && this.status == 200) {

                  console.log("Array vindo do back",this.responseText);
                  let objBack = JSON.parse(this.responseText);

                  for(let i = 0; i < objBack.length ; i++){

                    let dropCategory = document.getElementById("categ");
                    let category = new Option(objBack[i], objBack[i]);
                    dropCategory.options.add(category);

                  }

                }

              }

              xmlHttp.open("GET", "main.php?act=categ", true);
              xmlHttp.send();
              console.log("requisição enviada");
            }

            function dropTipo(){

              let xmlHttp = new XMLHttpRequest();
              xmlHttp.onreadystatechange = function() {

                if (this.readyState == 4 && this.status == 200) {

                  console.log("Array vindo do back",this.responseText);
                  let objBack = JSON.parse(this.responseText);

                  for(let i = 0; i < objBack.length ; i++){

                    let dropType = document.getElementById("tipo");
                    let type = new Option(objBack[i], objBack[i]);
                    dropType.options.add(type);

                  }

                }

              }

              xmlHttp.open("GET", "main.php?act=tipo", true);
              xmlHttp.send();
              console.log("requisição enviada");
            }

          </script>

      </form>

    </div>

  </body>

</html>
